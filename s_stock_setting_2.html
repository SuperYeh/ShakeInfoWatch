<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=gb2312"/>
<title>S Stock China</title>
<style type="text/css">
html {height:auto;}
body {height:auto; margin:0; padding: 0;}
</style>
<link rel='stylesheet' type='text/css' href='css/slate.min.css'>
<link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css" />
<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.3.2.min.js"></script>
<script type="text/javascript" src='js/slate.js'></script>

</head>

<body>
	<div data-role="header" class="jqm-header">
		<h1>Setting</h1>
	</div>	

	<div id="main">
		<div data-role="content">
			
	<fieldset data-role="controlgroup" data-mini="true">
		
		<fieldset class="ui-grid-a">
				<div class="ui-block-a" style="width:80px; padding-right:5px;">
				<label for="key_stock0_name">股票简称</label>	
				<input name="key_stock0_name" id="key_stock0_name" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-b" style="width:90px; padding-right:5px;">
				<label for="key_stock0_id">股票编码</label>	
				<input name="key_stock0_id" id="key_stock0_id" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-c" style="width:70px; padding-right:5px;">
				<label for="key_stock0_hv">涨预警</label>
				<input name="key_stock0_hv" id="key_stock0_hv" value="" type="text" maxlength="6">
				</div>	
				<div class="ui-block-d" style="width:70px; padding-right:5px;">
				<label for="key_stock0_lv">跌预警</label>
				<input name="key_stock0_lv" id="key_stock0_lv" value="" type="text" maxlength="6">
				</div>	
		</fieldset>				
		<fieldset class="ui-grid-a">
				<div class="ui-block-a" style="width:80px; padding-right:5px;">
				<input name="key_stock1_name" id="key_stock1_name" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-b" style="width:90px; padding-right:5px;">
				<input name="key_stock1_id" id="key_stock1_id" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-c" style="width:70px; padding-right:5px;">
				<input name="key_stock1_hv" id="key_stock1_hv" value="" type="text" maxlength="6">
				</div>	
				<div class="ui-block-d" style="width:70px; padding-right:5px;">
				<input name="key_stock1_lv" id="key_stock1_lv" value="" type="text" maxlength="6">
				</div>	
		</fieldset>	
		<fieldset class="ui-grid-a">
				<div class="ui-block-a" style="width:80px; padding-right:5px;">
				<input name="key_stock2_name" id="key_stock2_name" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-b" style="width:90px; padding-right:5px;">
				<input name="key_stock2_id" id="key_stock2_id" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-c" style="width:70px; padding-right:5px;">
				<input name="key_stock2_hv" id="key_stock2_hv" value="" type="text" maxlength="6">
				</div>	
				<div class="ui-block-d" style="width:70px; padding-right:5px;">
				<input name="key_stock2_lv" id="key_stock2_lv" value="" type="text" maxlength="6">
				</div>	
		</fieldset>	
		<fieldset class="ui-grid-a">
				<div class="ui-block-a" style="width:80px; padding-right:5px;">
				<input name="key_stock3_name" id="key_stock3_name" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-b" style="width:90px; padding-right:5px;">
				<input name="key_stock3_id" id="key_stock3_id" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-c" style="width:70px; padding-right:5px;">
				<input name="key_stock3_hv" id="key_stock3_hv" value="" type="text" maxlength="6">
				</div>	
				<div class="ui-block-d" style="width:70px; padding-right:5px;">
				<input name="key_stock3_lv" id="key_stock3_lv" value="" type="text" maxlength="6">
				</div>	
		</fieldset>		
		<fieldset class="ui-grid-a">
				<div class="ui-block-a" style="width:80px; padding-right:5px;">
				<input name="key_stock4_name" id="key_stock4_name" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-b" style="width:90px; padding-right:5px;">
				<input name="key_stock4_id" id="key_stock4_id" value="" type="text" maxlength="8">
				</div>
				<div class="ui-block-c" style="width:70px; padding-right:5px;">
				<input name="key_stock4_hv" id="key_stock4_hv" value="" type="text" maxlength="6">
				</div>	
				<div class="ui-block-d" style="width:70px; padding-right:5px;">
				<input name="key_stock4_lv" id="key_stock5_lv" value="" type="text" maxlength="6">
				</div>	
		</fieldset>	

	</fieldset>
		

<br />
<div class="ui-body ui-body-c">
    <fieldset class="ui-grid-a">
        <div class="ui-block-a"><button type="submit" data-theme="d" id="b-cancel">&#x53D6;&#x6D88;</button></div>
        <div class="ui-block-b"><button type="submit" data-theme="a" id="b-submit">&#x786E;&#x5B9A;</button></div>
    </fieldset>
</div>

 		
		</div>
	</div>
		
		
    <script>
	        /** HTML接收参数 */  
		function   request(paramName) {  
		    //获取URL的字符串  
		    var sSource = String(window.document.location);  
		    var sName = paramName;    
		    var sReturn = "";     
		    var sQUS = "?";     
		    var sAMP = "&";     
		    var sEQ = "=";     
		    var iPos;  
		  
		    //获取sSource中的"?"，无则返回 -1  
		    iPos = sSource.indexOf(sQUS);  
		    if(iPos==-1) return;   
      
		    //汲取参数，从iPos位置到sSource.length-iPos的位置，  
		    var strQuery = sSource.substr(iPos,sSource.length-iPos);   
 
		    // alert(strQuery);   
		    //先全部转换为小写  
		    var strLCQuery = strQuery.toLowerCase();     
		    var strLCName  = sName.toLowerCase();   
  
		    //从子字符串strLCQuery中查找“?”、参数名，以及“=”，即“?参数名=”  
		    iPos = strLCQuery.indexOf(sQUS + strLCName + sEQ);  
		    //alert(iPos);  
		    //如果不存在    
		    if(iPos == -1) {     
		        //继续查找可能的后一个参数，即带“&参数名=”  
		        iPos = strLCQuery.indexOf(sAMP + strLCName + sEQ);  
		    }  
  
		    //判断是否存在参数  
		    if(iPos != -1) {      
		        sReturn = strQuery.substr(iPos + sName.length + 2,strQuery.length-(iPos + sName.length + 2));     
		        var iPosAMP = sReturn.indexOf(sAMP);     
		        if (iPosAMP == -1) {  
		            return   sReturn;     
		        } else {     
		            sReturn = sReturn.substr(0,iPosAMP);     
		        }     
		    }  
		    return   sReturn;   
		}  
	
		function getConfigData() {
		    var options = {
				'key_stock0_name'      : $("input[name=key_stock0_name]").val(),
				'key_stock0_id'        : $("input[name=key_stock0_id]").val().replace(" "),
				'key_stock0_hv'        : $("input[name=key_stock0_hv]").val(),
				'key_stock0_lv'        : $("input[name=key_stock0_lv]").val(),
				'key_stock1_name'      : $("input[name=key_stock1_name]").val(),
				'key_stock1_id'        : $("input[name=key_stock1_id]").val().replace(" "),
				'key_stock1_hv'        : $("input[name=key_stock1_hv]").val(),
				'key_stock1_lv'        : $("input[name=key_stock1_lv]").val(),
				'key_stock2_name'      : $("input[name=key_stock2_name]").val(),
				'key_stock2_id'        : $("input[name=key_stock2_id]").val().replace(" "),
				'key_stock2_hv'        : $("input[name=key_stock2_hv]").val(),
				'key_stock2_lv'        : $("input[name=key_stock2_lv]").val(),
				'key_stock3_name'      : $("input[name=key_stock3_name]").val(),
				'key_stock3_id'        : $("input[name=key_stock3_id]").val().replace(" "),
				'key_stock3_hv'        : $("input[name=key_stock3_hv]").val(),
				'key_stock3_lv'        : $("input[name=key_stock3_lv]").val(),
				'key_stock4_name'      : $("input[name=key_stock4_name]").val(),
				'key_stock4_id'        : $("input[name=key_stock4_id]").val().replace(" "),
				'key_stock4_hv'        : $("input[name=key_stock4_hv]").val(),
				'key_stock4_lv'        : $("input[name=key_stock4_lv]").val(),
			}
			return options;
		}
		
		function getQueryParam(variable, defaultValue) {
    			var query = location.search.substring(1);
    			var vars = query.split('&');
    			for (var i = 0; i < vars.length; i++) {
      				var pair = vars[i].split('=');
      				if (pair[0] === variable) {
        				return decodeURIComponent(pair[1]);
      				}
    			}
    			return defaultValue || false;
  		}
		
		$().ready(function() {
			
		   	if (typeof window.localStorage !== "undefined") {
				if (window.localStorage.swatch_options) {
					var ls_pto = JSON.parse(window.localStorage.swatch_options);
					
					if ("key_stock0_name" in ls_pto) 
						$("input[name=key_stock0_name]").val(ls_pto["key_stock0_name"]);
					if ("key_stock0_id" in ls_pto) 
						$("input[name=key_stock0_id]").val(ls_pto["key_stock0_id"]);
					if ("key_stock0_hv" in ls_pto) 
						$("input[name=key_stock0_hv]").val(ls_pto["key_stock0_hv"]);
					if ("key_stock0_lv" in ls_pto) 
						$("input[name=key_stock0_lv]").val(ls_pto["key_stock0_lv"]);
					if ("key_stock1_name" in ls_pto) 
						$("input[name=key_stock1_name]").val(ls_pto["key_stock1_name"]);
					if ("key_stock1_id" in ls_pto) 
						$("input[name=key_stock1_id]").val(ls_pto["key_stock1_id"]);
					if ("key_stock1_hv" in ls_pto) 
						$("input[name=key_stock1_hv]").val(ls_pto["key_stock1_hv"]);
					if ("key_stock1_lv" in ls_pto) 
						$("input[name=key_stock1_lv]").val(ls_pto["key_stock1_lv"]);
					if ("key_stock2_name" in ls_pto) 
						$("input[name=key_stock2_name]").val(ls_pto["key_stock2_name"]);
					if ("key_stock2_id" in ls_pto) 
						$("input[name=key_stock2_id]").val(ls_pto["key_stock2_id"]);
					if ("key_stock2_hv" in ls_pto) 
						$("input[name=key_stock2_hv]").val(ls_pto["key_stock2_hv"]);
					if ("key_stock2_lv" in ls_pto) 
						$("input[name=key_stock2_lv]").val(ls_pto["key_stock2_lv"]);
					if ("key_stock3_name" in ls_pto) 
						$("input[name=key_stock3_name]").val(ls_pto["key_stock3_name"]);
					if ("key_stock3_id" in ls_pto) 
						$("input[name=key_stock3_id]").val(ls_pto["key_stock3_id"]);
					if ("key_stock3_hv" in ls_pto) 
						$("input[name=key_stock3_hv]").val(ls_pto["key_stock3_hv"]);
					if ("key_stock3_lv" in ls_pto) 
						$("input[name=key_stock3_lv]").val(ls_pto["key_stock3_lv"]);
					if ("key_stock4_name" in ls_pto) 
						$("input[name=key_stock4_name]").val(ls_pto["key_stock4_name"]);
					if ("key_stock4_id" in ls_pto) 
						$("input[name=key_stock4_id]").val(ls_pto["key_stock4_id"]);
					if ("key_stock4_hv" in ls_pto) 
						$("input[name=key_stock4_hv]").val(ls_pto["key_stock4_hv"]);
					if ("key_stock4_lv" in ls_pto) 
						$("input[name=key_stock4_lv]").val(ls_pto["key_stock4_lv"]);
				}
			}
											
			$("#b-cancel").click(function() {
				console.log("Cancel");
				document.location = "pebblejs://close";
			});
			
/*
			$("#b-submit").click(function() {
				console.log("Submit");
				ls_pto = JSON.stringify(getConfigData());
				if (typeof window.localStorage !== "undefined") {
					window.localStorage.swatch_options = ls_pto;
				}
				var location = "pebblejs://close#" + encodeURIComponent(ls_pto);
				document.location = location;
			});
*/			
			var submitButton = document.getElementById('b-submit');
  			submitButton.addEventListener('click', function() {
    				console.log('Submit');
    				var ls_option = JSON.stringify(getConfigData());
    				if (typeof window.localStorage !== "undefined") {
					window.localStorage.swatch_options = ls_option;
				}
    				// Set the return URL depending on the runtime environment
    				var return_to = getQueryParam('return_to', 'pebblejs://close#');
    				document.location = return_to + encodeURIComponent(ls_option);
  			});
		});
   
    </script>
  </body>
</html>
